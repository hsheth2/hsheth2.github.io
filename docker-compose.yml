version: '2'

services:
  web:
    build: .
    restart: always
    labels:
      traefik.enable: true
      traefik.docker.network: "traefik"
      traefik.http.routers.harshal-sheth-io.rule: Host(`harshal.sheth.io`)
      traefik.http.routers.harshal-sheth-io.tls.certResolver: default
      traefik.http.routers.harshal-sheth-io.middlewares: SecureTLS
    networks:
      - traefik
      - default
  alternate:
    image: schmunk42/nginx-redirect
    restart: always
    environment:
      SERVER_REDIRECT: harshal.sheth.io
    labels:
      traefik.enable: true
      traefik.docker.network: "traefik"
      traefik.http.routers.harshal-sheth-alternate.rule: Host(`harshalsheth.me`, `www.harshalsheth.me`, `harshalsheth.tk`, `www.harshalsheth.tk`)
      traefik.http.routers.harshal-sheth-alternate.tls.certResolver: default
      traefik.http.routers.harshal-sheth-alternate.middlewares: SecureTLS
    networks:
      - traefik
      - default

networks:
  traefik:
    external: true
